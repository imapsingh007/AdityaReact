trigger:
  branches:
    include:
      - main  # or your desired branch

pool:
  vmImage: 'ubuntu-latest'

stages:
- stage: Build
  jobs:
  - job: Build
    steps:
      - task: NodeTool@0
        inputs:
          versionSpec: '14.x'
        displayName: 'Install Node.js'

      - script: |
          npm install
          npm run build
        displayName: 'Build React App'

      - task: PublishBuildArtifacts@1
        inputs:
          PathtoPublish: 'build'
          ArtifactName: 'drop'
        displayName: 'Publish Build Artifacts'

- stage: Deploy
  dependsOn: Build
  jobs:
  - job: Deploy
    pool:
      vmImage: 'ubuntu-latest'
    steps:
      - download: current
        artifact: drop
        displayName: 'Download Build Artifacts'

      - task: AzureFileCopy@4
        inputs:
          SourcePath: '$(System.ArtifactsDirectory)/drop'
          azureSubscription: 'Pay-As-You-Go'  # Replace with your Azure subscription name
          Destination: 'AzureBlob'
          storage: 'adityapstorage'  # Replace with your Storage Account name
          ContainerName: '$web'
          cleanTargetFolder: true
